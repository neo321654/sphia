New UI
Refactor code
Fixes and improvements